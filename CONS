from Bio import SeqIO
import numpy as np
np.set_printoptions(threshold=np.inf)

sequence, seq2 = [], []
with open ("../Downloads/rosalind_cons.txt",'r') as fa:
    for seq_record  in SeqIO.parse(fa,'fasta'):
        sequence.append(str(seq_record.name))
        seq2.append(str(seq_record.seq))
seq_len = len(seq2)
str_len = len(seq2[0])
elements=["A", "C", "G", "T"]
consensus_string = ""
matrix = np.zeros(shape=(4, str_len), dtype=int)
for c in range(str_len):
    position_symbol = [s[c] for s in seq2]
    symbol = max(position_symbol, key=position_symbol.count)
    consensus_string += symbol
    for r in range(len(elements)):
        matrix[r][c] = position_symbol.count(elements[r])    
print(consensus_string)
for i in range(len(elements)):
    print("{}: {}".format(elements[i], " ".join([str(j) for j in matrix[i]])))
